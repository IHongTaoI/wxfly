webpackJsonp([21],{kL0G:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("lC5x"),r=a.n(s),i=a("HzJ8"),n=a.n(i),l=a("IHPB"),c=a.n(l),o=a("J0Oq"),p=a.n(o),u=a("VAi0"),d=a("NmBu"),h={components:{replyList:u.a,replyEditBox:d.a},data:function(){return{loading:!1,showReplyBox:!1,finished:!1,tearPlaTxt:"发表评论",page:0,pageSize:20,reList:[],cacheObj:{},isReplayChild:!1,shareId:this.$route.query.shareId,cIndex:-1,pIndex:-1}},methods:{getList:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return p()(r.a.mark(function a(){var s,i,l,o,p,u,d,h,f,v;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s=e.$route.query.shareId,a.next=3,e.$apihelper.shareReplyAll({shareId:s,page:e.page,pageSize:e.pageSize});case 3:if(i=a.sent,e.loading=!1,i){a.next=7;break}return a.abrupt("return");case 7:for(e.page++,(l=i.d.replies).length<e.pageSize&&(e.finished=!0),o=!0,p=!1,u=void 0,a.prev=13,d=n()(l);!(o=(h=d.next()).done);o=!0)(f=h.value).replyTime=e.$utils.dateFromat(f.replyTime);a.next=21;break;case 17:a.prev=17,a.t0=a.catch(13),p=!0,u=a.t0;case 21:a.prev=21,a.prev=22,!o&&d.return&&d.return();case 24:if(a.prev=24,!p){a.next=27;break}throw u;case 27:return a.finish(24);case 28:return a.finish(21);case 29:t?(e.page=0,e.reList=l):(v=e.reList).push.apply(v,c()(l));case 30:case"end":return a.stop()}},a,e,[[13,17,21,29],[22,,24,28]])}))()},likeClick:function(e){var t=this;return p()(r.a.mark(function a(){var s,i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.reList[e].parse){a.next=2;break}return a.abrupt("return");case 2:return t.reList[e].parse=!0,t.reList[e].praseCount+=1,s=t.reList[e].id,i=t.reList[e].userId,a.next=7,t.$apihelper.parseLikeReplay({shareId:t.shareId,praseUserId:i,commentId:s,type:"A"});case 7:a.sent;case 8:case"end":return a.stop()}},a,t)}))()},replyChildBtn:function(e){var t=e.item,a=e.pIndex,s=e.cIndex;this.cIndex=s,this.pIndex=a,this.isReplayChild=!0,this.tearPlaTxt="回复"+t.userName,this.showReplyBox=!0,this.cacheObj={commentId:t.id,shareId:this.shareId,replyUserId:t.userId}},hidereplyBox:function(){this.showReplyBox=!1,this.textareaBlur()},textareaBlur:function(){this.isReplayChild=!1,this.tearPlaTxt="发表评论"},sumbitReplay:function(e){var t=this;return p()(r.a.mark(function a(){var s,i,n,l;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t.cacheObj.content=e,!t.isReplayChild){a.next=12;break}return a.next=4,t.$apihelper.shareReplyArticleChild(t.cacheObj);case 4:s=a.sent,console.log("回复二级评论",s),i=t.reList[t.pIndex],(n=t.reList[t.pIndex].replies).length>=2?i.replyCount+=1:(s.d.replyTime=t.$utils.dateFromat(s.d.replyTime),s.d.userName=t.$store.state.user.userInfo.userName,n.push(s.d)),t.hidereplyBox(),a.next=21;break;case 12:return a.next=14,t.$apihelper.shareReplyArticle(t.cacheObj);case 14:l=a.sent,console.log("回复楼主",l),l.d.replyTime=t.$utils.dateFromat(l.d.replyTime),l.d.userAvatar=t.$store.state.user.userInfo.userAvatar,l.d.userName=t.$store.state.user.userInfo.userName,t.reList.push(l.d),t.hidereplyBox();case 21:case"end":return a.stop()}},a,t)}))()},handlerClick:function(e){var t=this;return{replyBtn:function(){t.showReplyBox=!0,t.cacheObj={shareId:t.shareId}}}[e]()},onLoad:function(){this.getList(!1)}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"more-replay"},[a("div",{staticClass:"more-pos"},[a("div",{staticClass:"more-wrap paddingTopNav"},[a("van-nav-bar",{staticClass:"topNavBar",attrs:{title:"评论列表","left-text":"返回","left-arrow":""},on:{"click-left":function(t){return e.$router.back()}}}),e._v(" "),a("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.reList,function(t,s){return a("replyList",{key:s,attrs:{reItem:t,index:s,goType:"mc"},on:{btnClick:e.replyChildBtn,likeClick:e.likeClick}})}),1),e._v(" "),a("replyEditBox",{attrs:{tearPlaTxt:e.tearPlaTxt},on:{"on-submit":e.sumbitReplay},model:{value:e.showReplyBox,callback:function(t){e.showReplyBox=t},expression:"showReplyBox"}}),e._v(" "),a("div",{staticClass:"action-list"},[a("div",{staticClass:"edit",on:{click:function(t){return e.handlerClick("replyBtn")}}},[a("span",{staticClass:"iconfont icon-bianji",staticStyle:{"font-size":"20px"}}),e._v(" "),a("span",[e._v("写评论")])]),e._v(" "),e._m(0),e._v(" "),e._m(1),e._v(" "),e._m(2)]),e._v(" "),a("transition",{attrs:{"enter-active-class":"animated fadeInRight","leave-active-class":"animated fadeOutRight"}},[a("router-view",{staticClass:"app-content",staticStyle:{"z-index":"99"}})],1)],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"action-item"},[t("p",{staticClass:"iconfont icon-xihuancon"}),this._v(" "),t("p",{staticClass:"txt"},[this._v("1")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"action-item"},[t("p",{staticClass:"iconfont icon-pinglun"}),this._v(" "),t("p",{staticClass:"txt"},[this._v("1")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"action-item"},[t("p",{staticClass:"iconfont icon-zhuanfa"}),this._v(" "),t("p",{staticClass:"txt"},[this._v("1")])])}]};var v=a("C7Lr")(h,f,!1,function(e){a("xG1Y")},"data-v-18ef7bf8",null);t.default=v.exports},xG1Y:function(e,t){}});
//# sourceMappingURL=21.0d33064dba56a7eea42e.js.map