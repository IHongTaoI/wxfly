webpackJsonp([6],{"9TXU":function(t,e){},OC6q:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("lC5x"),n=s.n(i),a=s("J0Oq"),o=s.n(a),r=s("4YfN"),c=s.n(r),l={props:["itemObj","index","type"],methods:{previewImage:function(t,e){this.$utils.imagePreview(t,e)},gotoDetail:function(){this.$router.push({path:"/home/shardDetail",query:{id:this.itemObj.id}})},clickLike:function(){var t=this;return o()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.itemObj.parse){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$apihelper.parseLikeShare({shareId:t.itemObj.id,praseUserId:t.itemObj.shareUserId});case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:t.$store.commit("listHelper/Like",{index:t.index,type:t.type});case 8:case"end":return e.stop()}},e,t)}))()},caozuo:function(){this.$emit("action",this.itemObj)}},computed:{item:function(){return this.itemObj},itemHeight:function(){return this.itemObj.shareImg[0]?"270px":"150px"}}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list-item",on:{click:t.gotoDetail}},[s("div",{staticClass:"box"},[s("div",{staticClass:"header"},[s("div",{staticClass:"info"},[s("img",{staticClass:"userava",attrs:{src:t.item.shareUserAvatar}}),t._v(" "),s("div",{staticClass:"titles"},[s("p",{staticClass:"username"},[t._v("\n            "+t._s(t.item.shareUserName)+"\n            "),s("span",{staticClass:"addr"},[s("i",{staticClass:"iconfont icon-weizhi vtmiddle"}),t._v(" "),s("span",{staticClass:"vtmiddle"},[t._v(t._s(t.item.distance))])])]),t._v(" "),s("p",{staticClass:"time"},[t._v("\n            "+t._s(t.item.createTime)+"\n            "),s("span",{staticClass:"addr"},[t._v(t._s(t.item.shareAddress))])])])]),t._v(" "),s("div",{staticClass:"opt",on:{click:function(e){return e.stopPropagation(),t.caozuo(e)}}},[s("span",{staticClass:"iconfont icon-caozuo"})])]),t._v(" "),t.item.shareImg&&t.item.shareImg.length?s("div",{staticClass:"content"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.item.shareImg[0],expression:"item.shareImg[0]"}],staticClass:"imgs"},t._l(t.item.shareImg,function(e,i){return s("div",{key:i,class:["pic_item",{pic1:1==t.item.shareImg.length,pic3:t.item.shareImg.length>=3}]},[s("img",{staticClass:"pic",attrs:{mode:"aspectFill",src:e},on:{click:function(e){return e.stopPropagation(),t.previewImage(t.item.shareImg,i)}}})])}),0),t._v(" "),s("p",{staticClass:"shareContent"},[t._v(t._s(t.item.shareContent))])]):t._e(),t._v(" "),s("div",{staticClass:"footer"},[s("p",[s("span",{staticClass:"iconfont icon-liulan"}),t._v(" "),s("span",{staticClass:"count"},[t._v(t._s(t._f("countFromat")(t.item.shareBrowseCount)))])]),t._v(" "),s("p",[s("span",{staticClass:"iconfont",class:{"icon-xihuancon":!t.itemObj.parse,"icon-buoumaotubiao16":t.itemObj.parse},on:{click:function(e){return e.stopPropagation(),t.clickLike(e)}}}),t._v(" "),s("span",{staticClass:"count"},[t._v(t._s(t._f("countFromat")(t.item.shareLikeCount)))])]),t._v(" "),s("p",[s("span",{staticClass:"iconfont icon-pinglun"}),t._v(" "),s("span",{staticClass:"count"},[t._v(t._s(t._f("countFromat")(t.item.shareReplyCount)))])]),t._v(" "),s("p",[s("span",{staticClass:"iconfont icon-zhuanfa"}),t._v(" "),s("span",{staticClass:"count"},[t._v(t._s(t._f("countFromat")(t.item.shareTransmitCount)))])])])]),t._v(" "),s("div",{staticStyle:{height:"20px",background:"#f2f2f2"}})])},staticRenderFns:[]};var u=s("C7Lr")(l,h,!1,function(t){s("9TXU")},"data-v-60a2013d",null).exports,p=s("R4Sj"),v={name:"home",components:{shreaBox:u},activated:function(){var t=this;this.type=this.$utils.cache.homeType||"newest";var e=this.$utils.cache.homeActive;this.$utils.isNull(e)||(this.active=e),this.$nextTick(function(){t.setScrollT(),document.querySelector(".van-pull-refresh__track").style.height="100%"}),this.list.length&&!this.$route.params.reload||this.getList(!0)},deactivated:function(){this.$utils.cache.homeType=this.type,this.$refs.main.onscroll=null},data:function(){return{selObj:null,showActionsheetL:!1,isLoading:!1,isreload:!1,diseRefresh:!1,type:"newest",showGotoTop:!0,active:1,loading:!1,actions:[{name:"收藏",type:2}]}},methods:c()({},Object(p.b)("listHelper",["getlistHelper"]),{onLoad:function(){this.finished||this.loading||(this.loading=!0,this.list.length&&this.getList(!1))},tabsClick:function(t){this.$utils.cache.homeActive=t},onscroll:function(t,e){var s=e.offset;s<10?(this.diseRefresh=!1,this.showGotoTop=!1):(this.showGotoTop=!0,this.diseRefresh=!0),this.$utils.cache[this.type+"scroll"]=s},onRefresh:function(){this.getList(!0)},gotoTop:function(){this.setScrollT(0)},getList:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.getlistHelper({isreload:e,type:this.type,cb:function(){t.isLoading=!1,t.loading=!1,t.setScrollT()}})},actionHandler:function(t){this.selObj=t,this.showActionsheetL=!0},setScrollT:function(t){var e=this;this.$nextTick(function(){var s=void 0;s=e.$utils.isNull(t)?e.$utils.cache[e.type+"scroll"]:t,e.$refs.scrollBox&&(e.$refs.scrollBox.$el.scrollTop=s)})},onSelect:function(t,e){var s=this;return o()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(2!==t.type){e.next=5;break}return e.next=3,s.$apihelper.userCollect(s.selObj.id);case 3:e.sent&&s.$toast.success("收藏成功");case 5:s.showActionsheetL=!1;case 6:case"end":return e.stop()}},e,s)}))()},GetNearby:function(){var t=this;return o()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$BMap.getPosition();case 2:e.sent||t.$toast("获取地理位置失败"),t.getList(!0);case 5:case"end":return e.stop()}},e,t)}))()}}),watch:{active:function(t){1===t&&(this.type="newest",!this.list.length&&this.getList()),0===t&&(this.type="nearby",!this.list.length&&this.hasLatLng&&this.getList()),this.setScrollT()}},computed:c()({},Object(p.c)("listHelper",["newest","nearby","dynamic"]),Object(p.c)("user",["lat","lng","hasLatLng"]),{list:function(){var t=this.type;return"newest"===t?this.newest.list:"nearby"===t?this.nearby.list:"dynamic"===t?this.dynamic.list:void 0},noCanGetNearby:function(){return!this.hasLatLng&&"nearby"===this.type},finished:function(){var t=this.type;return"newest"===t?this.newest.finished:"nearby"===t?this.nearby.finished:"dynamic"===t?this.dynamic.finished:void 0}})},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"main",attrs:{id:"home"}},[s("div",{staticClass:"tabs"},[s("van-tabs",{on:{click:t.tabsClick},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[s("van-tab",{attrs:{title:"附近"}}),t._v(" "),s("van-tab",{attrs:{title:"最新"}})],1)],1),t._v(" "),s("van-pull-refresh",{staticClass:"refreshBox",attrs:{disabled:t.diseRefresh||t.noCanGetNearby},on:{refresh:t.onRefresh},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[s("p",{directives:[{name:"show",rawName:"v-show",value:t.noCanGetNearby,expression:"noCanGetNearby"}],staticClass:"noCanGetNearby"},[t._v("\n      抱歉未能获取您的位置信息\n      "),s("br"),t._v(" "),s("span",{staticStyle:{color:"blue"},on:{click:t.GetNearby}},[t._v("重新获取")])]),t._v(" "),t.noCanGetNearby?t._e():s("auto-virtual-list",{ref:"scrollBox",staticStyle:{width:"100%",height:"100%","padding-bottom":"60px"},on:{tobottom:t.onLoad,onscroll:t.onscroll}},[t._l(t.list,function(e,i){return s("shreaBox",{key:e.id,style:{height:e.height},attrs:{itemObj:e,index:i,type:t.type},on:{action:t.actionHandler}})}),t._v(" "),s("loadinganite",{directives:[{name:"show",rawName:"v-show",value:t.loading&&!t.noCanGetNearby,expression:"loading && !noCanGetNearby"}]}),t._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:t.finished&&t.list.length,expression:"finished && list.length"}],staticClass:"no-more"},[t._v("-------我也是有底线的-------")]),t._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:t.finished&&!t.list.length,expression:"finished && !list.length"}],staticClass:"no-more"},[t._v("-------列表空空如也-------")])],2)],1),t._v(" "),s("van-actionsheet",{attrs:{actions:t.actions,"cancel-text":"取消"},on:{select:t.onSelect},model:{value:t.showActionsheetL,callback:function(e){t.showActionsheetL=e},expression:"showActionsheetL"}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showGotoTop,expression:"showGotoTop"}],staticClass:"go-top"},[s("span",{staticClass:"iconfont icon-dingbu",on:{click:t.gotoTop}})])],1)},staticRenderFns:[]};var m=s("C7Lr")(v,d,!1,function(t){s("Zom+")},"data-v-61c62703",null);e.default=m.exports},"Zom+":function(t,e){}});
//# sourceMappingURL=6.5607f8fe25340bfb24af.js.map